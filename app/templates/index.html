<!DOCTYPE html><!--
* CoreUI PRO Bootstrap Admin Template
* @version v5.5.0
* @link https://coreui.io/product/bootstrap-dashboard-template/
* Copyright (c) 2025 creativeLabs Łukasz Holeczek
* License (https://coreui.io/pro/license/)
-->
<html lang="en">
  <head>
    <base href="./">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta name="description" content="CoreUI - Bootstrap Admin Template">
    <meta name="author" content="Łukasz Holeczek">
    <meta name="keyword" content="Bootstrap,Admin,Template,SCSS,HTML,RWD,Dashboard">
    <title>CoreUI Bootstrap Admin Template</title>
    <link rel="apple-touch-icon" sizes="57x57" href="static/assets/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="static/assets/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="static/assets/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="static/assets/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="static/assets/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="static/assets/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="static/assets/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="static/assets/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="static/assets/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="static/assets/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="static/assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="static/assets/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="static/assets/favicon/favicon-16x16.png">
    <link rel="manifest" href="static/assets/favicon/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="static/assets/favicon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <!-- Vendors styles-->
    <link rel="stylesheet" href="static/vendors/simplebar/css/simplebar.css">
    <!-- Main styles for this application-->
    <link href="static/css/style.css" rel="stylesheet">
    <!-- We use those styles to show code examples, you should remove them in your application.-->
    <link href="static/css/examples.css" rel="stylesheet">
    <script src="static/js/config.js"></script>
    <script src="static/js/color-modes.js"></script>
    <link href="static/vendors/@coreui/chartjs/css/coreui-chartjs.css" rel="stylesheet">
  </head>
  <body>
    <div class="card m-1">
        <div class="card-header">
            <ul class="nav nav-pills mb-3 gap-2" id="pills-tab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="pills-home-tab" data-coreui-toggle="pill" data-coreui-target="#nav-home" type="button" role="tab" aria-controls="pills-home" aria-selected="true">CONTENT</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="pills-profile-tab" data-coreui-toggle="pill" data-coreui-target="#nav-profile" type="button" role="tab" aria-controls="pills-profile" aria-selected="false">REUPLOAD</button>
                </li>
                <form class="d-flex" role="search">
                    <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                    <button class="btn btn-outline-success" type="submit">Search</button>
                </form>
                <button type="button" class="btn btn-primary" data-coreui-toggle="modal" data-coreui-target="#staticBackdrop">Upload File</button>
            </ul>
        </div>
        <div class="tab-content" id="nav-tabContent">
            <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab" tabindex="0">
                <div class="row row-cols-1 row-cols-md-6 g-1 m-1">
                    <div class="flex-column">
                        <video class="card-img-top" controls>
                            <source src="#" type="video/mp4">
                        </video>
                    </div>
                    <div class="flex-column">
                        <video class="card-img-top" controls>
                            <source src="#" type="video/mp4">
                        </video>
                    </div>
                    <div class="flex-column">
                        <video class="card-img-top" controls>
                            <source src="#" type="video/mp4">
                        </video>
                    </div>
                    <div class="flex-column">
                        <video class="card-img-top" controls>
                            <source src="#" type="video/mp4">
                        </video>
                    </div>
                    <div class="flex-column">
                        <video class="card-img-top" controls>
                            <source src="#" type="video/mp4">
                        </video>
                    </div>
                    <div class="flex-column">
                        <video class="card-img-top" controls>
                            <source src="#" type="video/mp4">
                        </video>
                    </div>
                    <div class="flex-column">
                        <video class="card-img-top" controls>
                            <source src="#" type="video/mp4">
                        </video>
                    </div>
                    <div class="flex-column">
                        <video class="card-img-top" controls>
                            <source src="#" type="video/mp4">
                        </video>
                    </div>
                    <div class="flex-column">
                        <video class="card-img-top" controls>
                            <source src="#" type="video/mp4">
                        </video>
                    </div>
                    <div class="flex-column">
                        <video class="card-img-top" controls>
                            <source src="#" type="video/mp4">
                        </video>
                    </div>
                    <div class="flex-column">
                        <video class="card-img-top" controls>
                            <source src="#" type="video/mp4">
                        </video>
                    </div>
                    <div class="flex-column">
                        <video class="card-img-top" controls>
                            <source src="#" type="video/mp4">
                        </video>
                    </div>
                    <div class="flex-column">
                        <video class="card-img-top" controls>
                            <source src="#" type="video/mp4">
                        </video>
                    </div>
                    <div class="flex-column">
                        <video class="card-img-top" controls>
                            <source src="#" type="video/mp4">
                        </video>
                    </div>
                </div>
            </div>
            <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab" tabindex="0">
                <div class="row row-cols-1 row-cols-md-6 g-1 m-1">
                    <div class="flex-column">
                        <video class="card-img-top" controls>
                            <source src="#" type="video/mp4">
                        </video>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="staticBackdrop" data-coreui-backdrop="static" data-coreui-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="staticBackdropLabel">UPLOAD FILE VIDEOS</h5>
                    <button type="button" class="btn-close" data-coreui-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Progress bar -->
                    <div class="mb-3">
                        <div class="progress" id="upload-progress">
                            <div class="progress-bar progress-bar-striped bg-success"
                                id="upload-progress-bar"
                                role="progressbar"
                                style="width: 0%;"
                                aria-valuenow="0"
                                aria-valuemin="0"
                                aria-valuemax="100">
                                0%
                            </div>
                        </div>
                    </div>

                    <!-- Progress label -->
                    <div class="col-auto d-none" id="upload-status-wrapper">
                        <label class="col-form-label" id="upload-status-label">Đang Tải Lên 0/0</label>
                    </div>

                    <!-- Hidden file input group -->
                    <div class="input-group mb-3 d-none" id="upload-input-group">
                        <input type="file"
                            class="form-control"
                            id="upload-file-input"
                            onchange="uploadFile(this)"
                            multiple>
                        <label class="input-group-text" for="upload-file-input">Upload</label>
                    </div>

                    <!-- Button trigger -->
                    <button class="btn btn-outline-primary w-100"
                            id="upload-trigger-btn"
                            onclick="document.getElementById('upload-file-input').click();">
                        ⬆️ Tải Lên Mới
                    </button>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-coreui-dismiss="modal">Close</button>
                </div>
                </div>
            </div>
        </div>

    </div>



    <!-- CoreUI and necessary plugins-->
    <script src="static/vendors/@coreui/coreui-pro/js/coreui.bundle.min.js"></script>
    <script src="static/vendors/simplebar/js/simplebar.min.js"></script>
    <script src="static/vendors/i18next/js/i18next.min.js"></script>
    <script src="static/vendors/i18next-http-backend/js/i18nextHttpBackend.js"></script>
    <script src="static/vendors/i18next-browser-languagedetector/js/i18nextBrowserLanguageDetector.js"></script>
    <script src="static/js/i18next.js"></script>
    <script>
      const header = document.querySelector('header.header');

      document.addEventListener('scroll', () => {
        if (header) {
          header.classList.toggle('shadow-sm', document.documentElement.scrollTop > 0);
        }
      });
    </script>
    <!-- Plugins and scripts required by this view-->
    <script src="static/vendors/chart.js/js/chart.umd.js"></script>
    <script src="static/vendors/@coreui/chartjs/js/coreui-chartjs.js"></script>
    <script src="static/vendors/@coreui/utils/js/index.js"></script>
    <script src="static/js/main.js"></script>
    <script>
        function getCurrentTabTarget() {
            const activeTab = document.querySelector('#pills-tab .nav-link.active');
            if (activeTab && activeTab.textContent.trim().toLowerCase() === 'content') {
                return 'content';
            } else if (activeTab && activeTab.textContent.trim().toLowerCase() === 'reupload') {
                return 'reupload';
            }
            return 'unknown';
        }
        function uploadFile(input) {
    const files = input.files;
    if (!files.length) return;

    const totalFiles = files.length;
    const targetTab = getCurrentTabTarget();
    const progressBar = document.querySelector('.progress-bar');
    const progressLabel = document.querySelector('#upload-status-label');
    document.getElementById('upload-status-wrapper').classList.remove('d-none');

    let current = 0;

    function uploadNext() {
        if (current >= totalFiles) {
            progressBar.style.width = '100%';
            progressBar.textContent = '100%';
            progressLabel.textContent = `Đã Tải Lên ${totalFiles}/${totalFiles}`;
            return;
        }

        const formData = new FormData();
        formData.append('file', files[current]);
        formData.append('target', targetTab);

        const xhr = new XMLHttpRequest();
        xhr.open('POST', '/upload/', true);

        xhr.upload.onprogress = function (event) {
            if (event.lengthComputable) {
                const percent = ((current + event.loaded / event.total) / totalFiles) * 100;
                progressBar.style.width = percent + '%';
                progressBar.textContent = `${Math.round(percent)}%`;
                progressLabel.textContent = `Đang Tải Lên ${current + 1}/${totalFiles}`;
            }
        };

        xhr.onload = function () {
                if (xhr.status === 200) {
                    current++;
                    uploadNext(); // Upload file tiếp theo
                } else {
                    alert(`Lỗi khi tải tệp ${files[current].name}`);
                }
            };

            xhr.onerror = function () {
                alert(`Lỗi kết nối khi tải tệp ${files[current].name}`);
            };

            xhr.send(formData);
        }

        uploadNext(); // Bắt đầu upload
    }

    </script>

  </body>
</html>